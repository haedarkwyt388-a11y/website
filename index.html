<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Real Login Vault</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
    margin:0;
    font-family:Arial;
    background:linear-gradient(135deg,#00ff88,#001a0f);
    display:flex;
    justify-content:center;
    align-items:center;
    min-height:100vh;
}

.card{
    width:350px;
    padding:25px;
    background:rgba(255,255,255,.12);
    backdrop-filter:blur(8px);
    border-radius:20px;
    box-shadow:0 20px 50px rgba(0,0,0,.6);
}

input,button{
    width:100%;
    padding:10px;
    margin:8px 0;
    border:none;
    border-radius:8px;
}

button{
    background:#00ff88;
    font-weight:bold;
    cursor:pointer;
}

.hidden{display:none}

.gallery{
    width:90%;
    max-width:900px;
}

.items{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(120px,1fr));
    gap:10px;
}

.item{
    background:rgba(255,255,255,.15);
    padding:8px;
    border-radius:10px;
    text-align:center;
}

img{
    width:100%;
    border-radius:8px;
}
.logout{
    background:red;
    color:white;
}
</style>
</head>

<body>

<!-- LOGIN -->
<div class="card" id="loginBox">
    <h2>Login / Register</h2>
    <input id="username" placeholder="Username">
    <input id="password" type="password" placeholder="Password">
    <button onclick="login()">Enter</button>
</div>

<!-- VAULT -->
<div class="card gallery hidden" id="vaultBox">
    <h2 id="welcome"></h2>
    <input type="file" id="upload" accept="image/*" multiple>
    <div class="items" id="items"></div>
    <button class="logout" onclick="logout()">Logout</button>
</div>

<script>
const loginBox = document.getElementById("loginBox");
const vaultBox = document.getElementById("vaultBox");
const itemsBox = document.getElementById("items");
const welcome = document.getElementById("welcome");

function login(){
    const u = username.value.trim();
    const p = password.value.trim();
    if(!u || !p){ alert("Fill fields"); return; }

    let users = JSON.parse(localStorage.getItem("users")||"{}");

    // إذا المستخدم جديد نسجله
    if(!users[u]){
        users[u] = { password:p, files:[] };
    }else{
        if(users[u].password !== p){
            alert("Wrong password");
            return;
        }
    }

    localStorage.setItem("users",JSON.stringify(users));
    localStorage.setItem("currentUser",u);

    showVault();
}

function showVault(){
    const user = localStorage.getItem("currentUser");
    if(!user) return;

    loginBox.classList.add("hidden");
    vaultBox.classList.remove("hidden");
    welcome.innerText = "Welcome " + user;
    loadFiles();
}

function loadFiles(){
    itemsBox.innerHTML="";
    const users = JSON.parse(localStorage.getItem("users"));
    const user = localStorage.getItem("currentUser");

    users[user].files.forEach(src=>{
        const div = document.createElement("div");
        div.className="item";
        div.innerHTML=`<img src="${src}">`;
        itemsBox.appendChild(div);
    });
}

upload.onchange = ()=>{
    const users = JSON.parse(localStorage.getItem("users"));
    const user = localStorage.getItem("currentUser");

    [...upload.files].forEach(file=>{
        const r = new FileReader();
        r.onload = ()=>{
            users[user].files.push(r.result);
            localStorage.setItem("users",JSON.stringify(users));
            loadFiles();
        }
        r.readAsDataURL(file);
    });
};

function logout(){
    localStorage.removeItem("currentUser");
    location.reload();
}

if(localStorage.getItem("currentUser")){
    showVault();
}
</script>

</body>
</html>
